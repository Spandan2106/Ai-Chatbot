/* Reset & Base Variables */
:root {
  --bg-dark: #0f172a;
  --bg-gradient: radial-gradient(circle at 50% 0%, #1e293b 0%, #0f172a 80%);
  --primary: #3b82f6;
  --primary-hover: #2563eb;
  --primary-glow: 0 0 15px rgba(59, 130, 246, 0.4);
  --accent: #06b6d4;
  --glass-bg: rgba(30, 41, 59, 0.7);
  --glass-border: 1px solid rgba(255, 255, 255, 0.08);
  --text-main: #f8fafc;
  --text-muted: #94a3b8;
  --font-main: system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
}

body { 
  margin: 0; 
  font-family: var(--font-main); 
  background: var(--bg-dark);
  background-image: var(--bg-gradient);
  color: var(--text-main); 
  height: 100vh; 
  height: 100dvh; /* Mobile viewport fix */
  overflow: hidden; 
  animation: bg-pulse 20s ease-in-out infinite;
}

#root { height: 100%; }

.app { 
  display: flex; 
  flex-direction: column; 
  height: 100%; 
  max-width: 1200px; 
  margin: 0 auto; 
  background: rgba(15, 23, 42, 0.5);
  box-shadow: 0 0 50px rgba(0,0,0,0.5);
}

/* Header */
.app__header { 
  padding: 1rem 1.5rem; 
  border-bottom: var(--glass-border); 
  display: flex; 
  align-items: center; 
  gap: 1rem; 
  background: rgba(15, 23, 42, 0.85); 
  -webkit-backdrop-filter: blur(12px);
  backdrop-filter: blur(12px); 
  z-index: 10;
}

.logo { 
  font-weight: 800; 
  font-size: 1.5rem; 
  background: linear-gradient(135deg, var(--primary), var(--accent)); 
  width: 42px; 
  height: 42px; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  border-radius: 12px; 
  box-shadow: var(--primary-glow);
}

.titles h1 { 
  margin: 0; 
  font-size: 1.25rem; 
  letter-spacing: -0.5px;
  background: linear-gradient(to right, #fff, #cbd5e1);
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
}
.titles p { margin: 0; font-size: 0.85rem; color: var(--text-muted); }

/* Chat Area */
.chat { flex: 1; display: flex; flex-direction: column; overflow: hidden; position: relative; }
.chat__list { 
  flex: 1; 
  overflow-y: auto; 
  padding: 1.5rem; 
  display: flex; 
  flex-direction: column; 
  gap: 1.5rem; 
  scroll-behavior: smooth;
}

/* Custom Scrollbar */
.chat__list::-webkit-scrollbar { width: 6px; }
.chat__list::-webkit-scrollbar-track { background: transparent; }
.chat__list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.1); border-radius: 3px; }
.chat__list::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.2); }

/* Messages */
.message { display: flex; flex-direction: column; gap: 0.4rem; max-width: 85%; animation: fadeIn 0.3s ease-out; }
.message--right { align-items: flex-end; }

.bubble { 
  padding: 1rem 1.25rem; 
  border-radius: 18px; 
  line-height: 1.6; 
  font-size: 0.95rem; 
  position: relative; 
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  word-wrap: break-word;
}

.bubble--user { 
  background: linear-gradient(135deg, var(--primary), #2563eb); 
  color: white; 
  border-bottom-right-radius: 4px; 
  box-shadow: var(--primary-glow);
}

.bubble--ai { 
  background: rgba(30, 41, 59, 0.8); 
  border: var(--glass-border); 
  border-bottom-left-radius: 4px; 
  -webkit-backdrop-filter: blur(5px);
  backdrop-filter: blur(5px);
}

.bubble--error { 
  background: rgba(220, 38, 38, 0.1); 
  border: 1px solid rgba(220, 38, 38, 0.4); 
  color: #fca5a5; 
}

.bubble__header { display: flex; align-items: center; gap: 0.6rem; font-size: 0.75rem; color: var(--text-muted); margin-bottom: 0.4rem; }
.avatar { width: 26px; height: 26px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 11px; background: rgba(255,255,255,0.1); font-weight: bold; border: 1px solid rgba(255,255,255,0.1); }
.small { font-size: 0.75rem; color: var(--text-muted); }
code { background: rgba(0,0,0,0.3); padding: 0.2rem 0.4rem; border-radius: 4px; font-family: 'Fira Code', monospace; color: var(--accent); }

/* Composer & Input */
.composer { padding: 1.5rem; border-top: var(--glass-border); background: rgba(15, 23, 42, 0.9); -webkit-backdrop-filter: blur(20px); backdrop-filter: blur(20px); }
.composer__inner { max-width: 900px; margin: 0 auto; width: 100%; }

.box { 
  display: flex; flex-direction: column; gap: 0.75rem; 
  background: rgba(30, 41, 59, 0.5); 
  padding: 0.75rem; 
  border-radius: 16px; 
  border: var(--glass-border); 
  transition: border-color 0.2s, box-shadow 0.2s;
}
.box:focus-within { border-color: var(--primary); box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.3); }

.input { 
  width: 100%; padding: 0.5rem; border: none; background: transparent; 
  color: white; resize: none; font-family: inherit; font-size: 1rem; outline: none; 
  min-height: 24px;
}
.input::placeholder { color: rgba(255,255,255,0.3); }

.toolbar { display: flex; justify-content: space-between; align-items: center; padding-top: 0.5rem; border-top: 1px solid rgba(255,255,255,0.05); }
.toolbar__actions { display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap; }

/* Buttons */
.btn { 
  padding: 0.6rem 1.2rem; cursor: pointer; background: var(--primary); color: white; 
  border: none; border-radius: 10px; display: flex; align-items: center; gap: 0.5rem; 
  font-weight: 600; font-size: 0.9rem; transition: all 0.2s ease; 
}
.btn:hover:not(:disabled) { background: var(--primary-hover); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3); }
.btn:disabled { opacity: 0.6; cursor: not-allowed; filter: grayscale(0.5); }

.ghost { background: rgba(255,255,255,0.05); color: var(--text-muted); border: 1px solid transparent; padding: 0.6rem; border-radius: 8px; }
.ghost:hover { background: rgba(255,255,255,0.1); color: white; }

select.ghost { 
  appearance: none; padding-right: 2rem; 
  background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%2394a3b8%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
  background-repeat: no-repeat; background-position: right 0.7rem top 50%; background-size: 0.65rem auto;
}
select.ghost option { background: #1e293b; color: white; }

/* Typing Animation */
.typing { display: flex; align-items: center; gap: 6px; padding: 4px 8px; }
.typing__dot { width: 6px; height: 6px; background-color: var(--accent); border-radius: 50%; animation: typing 1.4s infinite ease-in-out both; }
.typing__dot:nth-child(1) { animation-delay: -0.32s; }
.typing__dot:nth-child(2) { animation-delay: -0.16s; }
@keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

.listening { 
  color: #ef4444 !important; border-color: rgba(239, 68, 68, 0.3) !important; 
  background: rgba(239, 68, 68, 0.1) !important; animation: pulse 1.5s infinite; 
}
@keyframes pulse { 
  0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); } 
  70% { box-shadow: 0 0 0 6px rgba(239, 68, 68, 0); } 
  100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); } 
}

@keyframes bg-pulse {
  0% { background-size: 100% 100%; }
  50% { background-size: 120% 120%; }
  100% { background-size: 100% 100%; }
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
  .app__header { padding: 0.75rem 1rem; }
  .chat__list { padding: 1rem; }
  .bubble { max-width: 90%; padding: 0.8rem 1rem; }
  .composer { padding: 1rem; }
  .toolbar { flex-wrap: wrap; gap: 0.5rem; }
  .toolbar > div:first-child { width: 100%; margin-bottom: 0.5rem; order: -1; }
  .toolbar__actions { width: 100%; justify-content: space-between; }
  .btn { padding: 0.6rem 1rem; }
}